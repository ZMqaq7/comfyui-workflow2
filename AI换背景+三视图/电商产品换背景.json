{"last_node_id":33,"last_link_id":49,"nodes":[{"id":18,"type":"IPAdapterAdvanced","pos":[1820,-1125],"size":{"0":298.1609802246094,"1":367.09771728515625},"flags":{},"order":14,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":32,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":33,"label":"ipadapter"},{"name":"image","type":"IMAGE","link":38,"slot_index":2,"label":"image"},{"name":"image_negative","type":"IMAGE","link":null,"label":"image_negative"},{"name":"attn_mask","type":"MASK","link":null,"label":"attn_mask"},{"name":"clip_vision","type":"CLIP_VISION","link":36,"slot_index":5,"label":"clip_vision"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[41],"shape":3,"slot_index":0,"label":"MODEL"}],"properties":{"Node name for S&R":"IPAdapterAdvanced"},"widgets_values":[0.5,"linear","concat",0,1,"V only"],"color":"#223","bgcolor":"#335","serialize_values":[null,null,null,null,null,null]},{"id":22,"type":"PrepImageForClipVision","pos":[1417,-1166],"size":{"0":315,"1":106},"flags":{},"order":8,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":37,"label":"image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[38],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"PrepImageForClipVision"},"widgets_values":["LANCZOS","center",0.15],"color":"#223","bgcolor":"#335","serialize_values":[null,null,null]},{"id":19,"type":"IPAdapterUnifiedLoader","pos":[1418,-972],"size":{"0":315,"1":78},"flags":{},"order":9,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":31,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":null,"label":"ipadapter"}],"outputs":[{"name":"model","type":"MODEL","links":[32],"shape":3,"slot_index":0,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","links":[33],"shape":3,"slot_index":1,"label":"ipadapter"}],"properties":{"Node name for S&R":"IPAdapterUnifiedLoader"},"widgets_values":["PLUS (high strength)"],"color":"#223","bgcolor":"#335","serialize_values":[null]},{"id":21,"type":"CLIPVisionLoader","pos":[1419,-834],"size":{"0":348.27386474609375,"1":87.21280670166016},"flags":{},"order":0,"mode":0,"outputs":[{"name":"CLIP_VISION","type":"CLIP_VISION","links":[36],"shape":3,"label":"CLIP_VISION"}],"properties":{"Node name for S&R":"CLIPVisionLoader"},"widgets_values":["IPA-image-encoder-sd15.safetensors"],"color":"#223","bgcolor":"#335","serialize_values":[null]},{"id":12,"type":"ControlNetApplyAdvanced","pos":[1813.4735235705762,-595.4204129484087],"size":{"0":315,"1":166},"flags":{},"order":16,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":13,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":14,"label":"negative"},{"name":"control_net","type":"CONTROL_NET","link":17,"slot_index":2,"label":"control_net"},{"name":"image","type":"IMAGE","link":18,"label":"image"}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[19],"shape":3,"slot_index":0,"label":"positive"},{"name":"negative","type":"CONDITIONING","links":[20],"shape":3,"slot_index":1,"label":"negative"}],"properties":{"Node name for S&R":"ControlNetApplyAdvanced"},"widgets_values":[1,0,1],"color":"#432","bgcolor":"#653","serialize_values":[null,null,null]},{"id":24,"type":"DifferentialDiffusion","pos":[2214,-1153],"size":{"0":210,"1":26},"flags":{},"order":19,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":41,"label":"model"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[42],"shape":3,"slot_index":0,"label":"MODEL"}],"properties":{"Node name for S&R":"DifferentialDiffusion"},"color":"#332922","bgcolor":"#593930"},{"id":14,"type":"InpaintModelConditioning","pos":[2226,-1057],"size":{"0":216.59999084472656,"1":106},"flags":{},"order":21,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":19,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":20,"label":"negative"},{"name":"vae","type":"VAE","link":23,"label":"vae"},{"name":"pixels","type":"IMAGE","link":24,"label":"pixels"},{"name":"mask","type":"MASK","link":44,"label":"mask"}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[21],"shape":3,"slot_index":0,"label":"positive"},{"name":"negative","type":"CONDITIONING","links":[22],"shape":3,"slot_index":1,"label":"negative"},{"name":"latent","type":"LATENT","links":[29],"shape":3,"slot_index":2,"label":"latent"}],"properties":{"Node name for S&R":"InpaintModelConditioning"},"color":"#332922","bgcolor":"#593930"},{"id":2,"type":"CLIPTextEncode","pos":[765.0405697292755,-1160.436746560509],"size":{"0":520.3628540039062,"1":176.69326782226562},"flags":{},"order":10,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":1,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[13],"shape":3,"slot_index":0,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["a (cosmetic product:0.8) photoshoot, at desk, high quality, highly detailed, 4k, ((product shoot beautiful)), cinematic,  "],"color":"#232","bgcolor":"#353","serialize_values":["a (cosmetic product:0.8) photoshoot, at desk, high quality, highly detailed, 4k, ((product shoot beautiful)), cinematic,  "]},{"id":3,"type":"CLIPTextEncode","pos":[773,-884],"size":{"0":510.6423645019531,"1":145.0332794189453},"flags":{},"order":11,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":2,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[14],"shape":3,"slot_index":0,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["nude, watermark, noisy, glitch, glitch, noise, jpeg artifacts, bad,embedding:EasyNegative, embedding:EasyNegativeV2, "],"color":"#322","bgcolor":"#533","serialize_values":["nude, watermark, noisy, glitch, glitch, noise, jpeg artifacts, bad,embedding:EasyNegative, embedding:EasyNegativeV2, "]},{"id":15,"type":"ImageRemoveBackground+","pos":[2510,-589],"size":{"0":241.79998779296875,"1":46},"flags":{},"order":13,"mode":0,"inputs":[{"name":"rembg_session","type":"REMBG_SESSION","link":25,"label":"rembg_session"},{"name":"image","type":"IMAGE","link":26,"label":"image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":null,"shape":3,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":[27,39],"shape":3,"slot_index":1,"label":"MASK"}],"properties":{"Node name for S&R":"ImageRemoveBackground+"},"color":"#2a363b","bgcolor":"#3f5159"},{"id":7,"type":"PreviewImage","pos":[2211,-414],"size":{"0":210,"1":246},"flags":{},"order":15,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":5,"label":"images"}],"properties":{"Node name for S&R":"PreviewImage"},"color":"#2a363b","bgcolor":"#3f5159"},{"id":17,"type":"MaskPreview+","pos":[2447,-409],"size":{"0":210,"1":246},"flags":{},"order":17,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":27,"label":"mask"}],"properties":{"Node name for S&R":"MaskPreview+"},"color":"#2a363b","bgcolor":"#3f5159"},{"id":23,"type":"InvertMask","pos":[2686,-472],"size":{"0":140,"1":28.550535202026367},"flags":{},"order":18,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":39,"label":"mask"}],"outputs":[{"name":"MASK","type":"MASK","links":[43],"shape":3,"slot_index":0,"label":"MASK"}],"properties":{"Node name for S&R":"InvertMask"},"color":"#2a363b","bgcolor":"#3f5159"},{"id":25,"type":"GrowMask","pos":[2670,-326],"size":{"0":210,"1":87.9912109375},"flags":{},"order":20,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":43,"label":"mask"}],"outputs":[{"name":"MASK","type":"MASK","links":[44],"shape":3,"slot_index":0,"label":"MASK"}],"properties":{"Node name for S&R":"GrowMask"},"widgets_values":[4,true],"color":"#2a363b","bgcolor":"#3f5159","serialize_values":[null,null]},{"id":8,"type":"KSampler","pos":[2556,-1167],"size":{"0":315,"1":474},"flags":{},"order":22,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":42,"label":"model"},{"name":"positive","type":"CONDITIONING","link":21,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":22,"label":"negative"},{"name":"latent_image","type":"LATENT","link":29,"label":"latent_image"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[11],"shape":3,"slot_index":0,"label":"LATENT"}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[479932692307915,"randomize",7,2,"dpmpp_sde","karras",1],"color":"#332922","bgcolor":"#593930","serialize_values":[null,null,null,null,null,null,null]},{"id":9,"type":"VAEDecode","pos":[2233,-856],"size":{"0":210,"1":46},"flags":{},"order":23,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":11,"label":"samples"},{"name":"vae","type":"VAE","link":30,"label":"vae"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[47],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"VAEDecode"},"color":"#332922","bgcolor":"#593930"},{"id":16,"type":"RemBGSession+","pos":[2203,-591],"size":{"0":263.7827453613281,"1":92.49649047851562},"flags":{},"order":1,"mode":0,"outputs":[{"name":"REMBG_SESSION","type":"REMBG_SESSION","links":[25],"shape":3,"slot_index":0,"label":"REMBG_SESSION"}],"properties":{"Node name for S&R":"RemBGSession+"},"widgets_values":["u2net: general purpose","CUDA"],"color":"#2a363b","bgcolor":"#3f5159","serialize_values":[null,null]},{"id":5,"type":"ImageResize+","pos":[283,-933],"size":{"0":315,"1":218},"flags":{},"order":7,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":3,"label":"image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[4,24,26],"shape":3,"slot_index":0,"label":"IMAGE"},{"name":"width","type":"INT","links":null,"shape":3,"label":"width"},{"name":"height","type":"INT","links":null,"shape":3,"label":"height"}],"properties":{"Node name for S&R":"ImageResize+"},"widgets_values":[1024,0,"nearest",true,"always",0],"color":"#7d814b","bgcolor":"#696d37","serialize_values":[null,null,null,null,null,null]},{"id":29,"type":"PreviewImage","pos":[1590,-201],"size":{"0":481.7674560546875,"1":1057.5584716796875},"flags":{},"order":24,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":47,"label":"images"}],"properties":{"Node name for S&R":"PreviewImage"},"color":"#323","bgcolor":"#535"},{"id":33,"type":"Note","pos":[166,-639],"size":{"0":1193.2420654296875,"1":314.0301208496094},"flags":{},"order":2,"mode":0,"properties":{"text":""},"widgets_values":["本工作流的主要核心:\n\n1. 通过IPAdapter来提取上传背景参考图片中的元素，从而在于产品图再次融合的时候提取这些元素特征重新生成背景参考图\n\n2. RemBG Session节点是主要对上传的商品白底图进行算法的计算，将上传的产品图进行去背景的抠图。这种抠图方法对比segmentAnything语义分割的抠图方法要好很多。算法会将抠图的描边抠的不完美的地方自动修复。\n\n3. InpaintModelConditioning：将去背景的产品图跟提示词以及上传的背景图进行无缝结合从而生成新的图像。"],"color":"#432","bgcolor":"#653","serialize_values":[null]},{"id":4,"type":"LoadImage","pos":[274,-193],"size":{"0":419.0721435546875,"1":1020.9258422851562},"flags":{},"order":3,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[3],"shape":3,"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["https://bfs.esheep.com/bfs/aikobo-bfs/app/comfy/d5ac56bed6098296cd32af75f5fbc43346317583.png@1536w_1536h_0e","image"],"color":"#323","bgcolor":"#535","serialize_values":[null,null]},{"id":20,"type":"LoadImage","pos":[872,-174],"size":{"0":598.6743774414062,"1":999.2442626953125},"flags":{},"order":4,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[37],"shape":3,"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["https://bfs.esheep.com/bfs/aikobo-bfs/app/comfy/1de3dd36086b651df126ab853580d89bafb8bbc2.png@1536w_1536h_0e","image"],"color":"#323","bgcolor":"#535","serialize_values":[null,null]},{"id":1,"type":"CheckpointLoaderSimple","pos":[186.63930435110618,-1150.6294465988897],"size":{"0":510.9066162109375,"1":153.1739501953125},"flags":{},"order":5,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[31],"shape":3,"slot_index":0,"label":"MODEL"},{"name":"CLIP","type":"CLIP","links":[1,2],"shape":3,"slot_index":1,"label":"CLIP"},{"name":"VAE","type":"VAE","links":[23,30],"shape":3,"slot_index":2,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["juggernautXL_v9-Lightning_4S_V9 + RDPhot(SDXL 1.0)"],"color":"#223","bgcolor":"#335","serialize_values":["5532_7636_8881@c8df560d29.safetensors"]},{"id":13,"type":"ControlNetLoader","pos":[1383.4735235705753,-591.4204129484087],"size":{"0":387.7154235839844,"1":81.15118408203125},"flags":{},"order":6,"mode":0,"outputs":[{"name":"CONTROL_NET","type":"CONTROL_NET","links":[17],"shape":3,"label":"CONTROL_NET"}],"properties":{"Node name for S&R":"ControlNetLoader"},"widgets_values":["control-lora-depth-rank256.safetensors"],"color":"#432","bgcolor":"#653","serialize_values":[null]},{"id":6,"type":"DepthAnythingPreprocessor","pos":[1404.4735235705753,-440.4204129484082],"size":{"0":315,"1":82},"flags":{},"order":12,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":4,"label":"image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[5,18],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"DepthAnythingPreprocessor"},"widgets_values":["depth_anything_vitl14.pth",1024],"color":"#432","bgcolor":"#653","serialize_values":[null,null]}],"links":[[1,1,1,2,0,"CLIP"],[2,1,1,3,0,"CLIP"],[3,4,0,5,0,"IMAGE"],[4,5,0,6,0,"IMAGE"],[5,6,0,7,0,"IMAGE"],[11,8,0,9,0,"LATENT"],[13,2,0,12,0,"CONDITIONING"],[14,3,0,12,1,"CONDITIONING"],[17,13,0,12,2,"CONTROL_NET"],[18,6,0,12,3,"IMAGE"],[19,12,0,14,0,"CONDITIONING"],[20,12,1,14,1,"CONDITIONING"],[21,14,0,8,1,"CONDITIONING"],[22,14,1,8,2,"CONDITIONING"],[23,1,2,14,2,"VAE"],[24,5,0,14,3,"IMAGE"],[25,16,0,15,0,"REMBG_SESSION"],[26,5,0,15,1,"IMAGE"],[27,15,1,17,0,"MASK"],[29,14,2,8,3,"LATENT"],[30,1,2,9,1,"VAE"],[31,1,0,19,0,"MODEL"],[32,19,0,18,0,"MODEL"],[33,19,1,18,1,"IPADAPTER"],[36,21,0,18,5,"CLIP_VISION"],[37,20,0,22,0,"IMAGE"],[38,22,0,18,2,"IMAGE"],[39,15,1,23,0,"MASK"],[41,18,0,24,0,"MODEL"],[42,24,0,8,0,"MODEL"],[43,23,0,25,0,"MASK"],[44,25,0,14,4,"MASK"],[47,9,0,29,0,"IMAGE"]],"groups":[{"title":"IPAdapter Group","bounding":[1371,-1271,799,581],"color":"#88A","font_size":24,"locked":false},{"title":"ControlNet Group","bounding":[1370,-680,804,364],"color":"#b58b2a","font_size":24,"locked":false},{"title":"Remove Background Group","bounding":[2187,-676,725,558],"color":"#3f789e","font_size":24,"locked":false},{"title":"KSampler Models","bounding":[2184,-1272,723,586],"color":"#b06634","font_size":24,"locked":false},{"title":"Model & Prompt","bounding":[175,-1274,1187,588],"color":"#3f789e","font_size":24,"locked":false},{"title":"Privew Images ","bounding":[158,-300,2023,1164],"color":"#a1309b","font_size":24,"locked":false}],"config":{},"extra":{},"version":0.4}