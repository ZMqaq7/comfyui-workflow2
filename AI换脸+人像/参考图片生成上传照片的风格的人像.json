{"last_node_id":76,"last_link_id":107,"nodes":[{"id":3,"type":"IPAdapterModelLoader","pos":[462.4886033935548,181.09634482574472],"size":{"0":308.341796875,"1":58.66658020019531},"flags":{},"order":0,"mode":0,"outputs":[{"name":"IPADAPTER","type":"IPADAPTER","links":[2],"shape":3,"label":"IP适配"}],"properties":{"Node name for S&R":"IPAdapterModelLoader"},"widgets_values":["ip-adapter-plus_sd15.bin"],"color":"#571a1a","bgcolor":"#6b2e2e","serialize_values":[null]},{"id":22,"type":"Apply ControlNet Stack","pos":[-966.0532040100096,172.15247545623765],"size":{"0":304.79998779296875,"1":66},"flags":{},"order":43,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":20,"label":"正面提示词"},{"name":"negative","type":"CONDITIONING","link":21,"label":"负面提示词"},{"name":"cnet_stack","type":"CONTROL_NET_STACK","link":25,"label":"ControlNet堆","slot_index":2}],"outputs":[{"name":"CONDITIONING+","type":"CONDITIONING","links":[22],"shape":3,"label":"正面条件","slot_index":0},{"name":"CONDITIONING-","type":"CONDITIONING","links":[23],"shape":3,"label":"负面条件","slot_index":1}],"properties":{"Node name for S&R":"Apply ControlNet Stack"},"color":"#43571a","bgcolor":"#576b2e","shape":1},{"id":26,"type":"CR Multi-ControlNet Stack","pos":[-243.0532040100098,303.15247545623754],"size":{"0":383.97515869140625,"1":499.201904296875},"flags":{},"order":37,"mode":0,"inputs":[{"name":"image_1","type":"IMAGE","link":26,"label":"图像1"},{"name":"image_2","type":"IMAGE","link":27,"label":"图像2"},{"name":"image_3","type":"IMAGE","link":null,"label":"图像3"},{"name":"controlnet_stack","type":"CONTROL_NET_STACK","link":null,"label":"ControlNet堆"}],"outputs":[{"name":"CONTROLNET_STACK","type":"CONTROL_NET_STACK","links":[25],"shape":3,"label":"ControlNet堆"},{"name":"show_help","type":"STRING","links":null,"shape":3,"label":"show_help"}],"properties":{"Node name for S&R":"CR Multi-ControlNet Stack"},"widgets_values":["On","control_v11p_sd15_openpose.pth",0.6,0,0.681,"On","control_sd15_inpaint_depth_hand_fp16.safetensors",0.51,0,0.45,"Off","None",1,0,1],"color":"#43571a","bgcolor":"#576b2e","serialize_values":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},{"id":35,"type":"Note","pos":[-990.0532040100096,306.15247545623754],"size":{"0":366.8714294433594,"1":330.69818115234375},"flags":{},"order":1,"mode":0,"properties":{"text":""},"widgets_values":["1.Conditioning到Ksampler之间要加入controlnet。因此这里添加了Apply controlnet stack节点链接controlnet\n\n2.Constrain image:链接原图，并可以对原图进行大小尺寸的设置"],"color":"#57431a","bgcolor":"#6b572e","serialize_values":[null]},{"id":31,"type":"SetLatentNoiseMask","pos":[-225.0532040100098,170.15247545623765],"size":{"0":340.4195556640625,"1":60.67594909667969},"flags":{},"order":44,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":29,"label":"Latent"},{"name":"mask","type":"MASK","link":51,"label":"遮罩"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[30],"shape":3,"label":"Latent","slot_index":0}],"properties":{"Node name for S&R":"SetLatentNoiseMask"},"color":"#1a572e","bgcolor":"#2e6b42"},{"id":40,"type":"Simple String","pos":[-634.5983386622096,1223.3731785308066],"size":{"0":315,"1":58},"flags":{},"order":2,"mode":0,"outputs":[{"name":"STRING","type":"STRING","links":[42],"shape":3,"label":"STRING"}],"properties":{"Node name for S&R":"Simple String"},"widgets_values":["hair"],"color":"#906b6b","bgcolor":"#a47f7f","serialize_values":[null]},{"id":42,"type":"GrowMask","pos":[-620.5983386622096,1338.3731785308066],"size":{"0":315,"1":82},"flags":{},"order":27,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":44,"label":"遮罩"}],"outputs":[{"name":"MASK","type":"MASK","links":[46],"shape":3,"label":"遮罩","slot_index":0}],"properties":{"Node name for S&R":"GrowMask"},"widgets_values":[-5,true],"color":"#1a5743","bgcolor":"#2e6b57","serialize_values":[null,null]},{"id":38,"type":"Simple String","pos":[-974.5983386622098,1238.3731785308066],"size":{"0":314.0323791503906,"1":58},"flags":{},"order":3,"mode":0,"outputs":[{"name":"STRING","type":"STRING","links":[40],"shape":3,"label":"STRING"}],"properties":{"Node name for S&R":"Simple String"},"widgets_values":["face"],"color":"#906b6b","bgcolor":"#a47f7f","serialize_values":[null]},{"id":43,"type":"MaskComposite","pos":[-278.5507879295351,1116.5630122573843],"size":{"0":308.4416198730469,"1":126},"flags":{},"order":32,"mode":0,"inputs":[{"name":"destination","type":"MASK","link":45,"label":"目标遮罩"},{"name":"source","type":"MASK","link":46,"label":"源遮罩"}],"outputs":[{"name":"MASK","type":"MASK","links":[47],"shape":3,"label":"遮罩","slot_index":0}],"properties":{"Node name for S&R":"MaskComposite"},"widgets_values":[0,0,"add"],"color":"#1a5743","bgcolor":"#2e6b57","serialize_values":[null,null,null]},{"id":41,"type":"GrowMask","pos":[-954.5983386622099,1339.3731785308066],"size":{"0":315,"1":82},"flags":{},"order":26,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":43,"label":"遮罩"}],"outputs":[{"name":"MASK","type":"MASK","links":[45,49],"shape":3,"label":"遮罩","slot_index":0}],"properties":{"Node name for S&R":"GrowMask"},"widgets_values":[-5,true],"color":"#1a5743","bgcolor":"#2e6b57","serialize_values":[null,null]},{"id":2,"type":"IPAdapterApply","pos":[463.274061157227,401.08145697784437],"size":{"0":315,"1":258},"flags":{},"order":39,"mode":0,"inputs":[{"name":"ipadapter","type":"IPADAPTER","link":2,"label":"IP适配","slot_index":0},{"name":"clip_vision","type":"CLIP_VISION","link":3,"label":"CLIP视觉","slot_index":1},{"name":"image","type":"IMAGE","link":36,"label":"图像","slot_index":2},{"name":"model","type":"MODEL","link":19,"label":"模型"},{"name":"attn_mask","type":"MASK","link":null,"label":"attn_mask"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[1],"shape":3,"label":"模型","slot_index":0}],"properties":{"Node name for S&R":"IPAdapterApply"},"widgets_values":[0.55,0.45,"original",0,1,false],"color":"#cb762f","bgcolor":"#df8a43","serialize_values":[null,null,null,null,null,null]},{"id":44,"type":"InvertMask","pos":[-280.5507879295351,1025.563012257385],"size":{"0":210,"1":26},"flags":{},"order":36,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":47,"label":"遮罩"}],"outputs":[{"name":"MASK","type":"MASK","links":[51],"shape":3,"label":"遮罩","slot_index":0}],"properties":{"Node name for S&R":"InvertMask"},"color":"#1a5743","bgcolor":"#2e6b57"},{"id":30,"type":"VAEEncode","pos":[-579.0532040100096,166.15247545623765],"size":{"0":274.95294189453125,"1":68.26110076904297},"flags":{},"order":40,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":53,"label":"图像","slot_index":0},{"name":"vae","type":"VAE","link":28,"label":"VAE"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[29],"shape":3,"label":"Latent","slot_index":0}],"properties":{"Node name for S&R":"VAEEncode"},"color":"#2e571a","bgcolor":"#426b2e"},{"id":39,"type":"CLIPSeg","pos":[-632.5983386622096,1039.3731785308078],"size":{"0":297.12359619140625,"1":146},"flags":{},"order":22,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":41,"label":"图像","slot_index":0},{"name":"text","type":"STRING","link":42,"widget":{"name":"text"},"slot_index":1,"label":"文本"}],"outputs":[{"name":"Mask","type":"MASK","links":[44],"shape":3,"label":"遮罩","slot_index":0},{"name":"Heatmap Mask","type":"IMAGE","links":null,"shape":3,"label":"热度图"},{"name":"BW Mask","type":"IMAGE","links":null,"shape":3,"label":"灰度图"}],"properties":{"Node name for S&R":"CLIPSeg"},"widgets_values":["",3,0.45,0],"color":"#572e1a","bgcolor":"#6b422e","serialize_values":["",null,null,null]},{"id":37,"type":"CLIPSeg","pos":[-971.5507879295345,1038.563012257385],"size":{"0":310.78302001953125,"1":146},"flags":{},"order":21,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":39,"label":"图像"},{"name":"text","type":"STRING","link":40,"widget":{"name":"text"},"slot_index":1,"label":"文本"}],"outputs":[{"name":"Mask","type":"MASK","links":[43],"shape":3,"label":"遮罩","slot_index":0},{"name":"Heatmap Mask","type":"IMAGE","links":[],"shape":3,"label":"热度图"},{"name":"BW Mask","type":"IMAGE","links":null,"shape":3,"label":"灰度图"}],"properties":{"Node name for S&R":"CLIPSeg"},"widgets_values":["",1,0.1,5],"color":"#572e1a","bgcolor":"#6b422e","serialize_values":["",null,null,null]},{"id":33,"type":"ConstrainImage|pysssss","pos":[-967.0532040100096,683.1524754562377],"size":{"0":302.67889404296875,"1":154},"flags":{},"order":17,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":37,"label":"图像","slot_index":0}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[33,35,39,41,53,61],"shape":6,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"ConstrainImage|pysssss"},"widgets_values":[768,768,0,0,"no"],"color":"#1a5757","bgcolor":"#2e6b6b","serialize_values":[null,null,null,null,null]},{"id":5,"type":"WD14Tagger|pysssss","pos":[-970.7405435211195,1767.464329049683],"size":{"0":397.4699401855469,"1":211.99972534179688},"flags":{},"order":19,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":4,"label":"图像","slot_index":0}],"outputs":[{"name":"STRING","type":"STRING","links":[9],"shape":6,"label":"字符串","slot_index":0}],"properties":{"Node name for S&R":"WD14Tagger|pysssss"},"widgets_values":["wd-v1-4-moat-tagger-v2",0.35,0.85,""],"color":"#6d5d22","bgcolor":"#817136","serialize_values":[null,null,null,null]},{"id":32,"type":"PixelPerfectResolution","pos":[-586.0532040100095,723.1524754562377],"size":{"0":328.56024169921875,"1":98},"flags":{},"order":28,"mode":0,"inputs":[{"name":"original_image","type":"IMAGE","link":35,"label":"图像"},{"name":"image_gen_width","type":"INT","link":54,"widget":{"name":"image_gen_width"},"label":"宽度","slot_index":1},{"name":"image_gen_height","type":"INT","link":55,"widget":{"name":"image_gen_height"},"label":"高度","slot_index":2}],"outputs":[{"name":"RESOLUTION (INT)","type":"INT","links":[32],"shape":3,"label":"分辨率(整数)","slot_index":0}],"properties":{"Node name for S&R":"PixelPerfectResolution"},"widgets_values":[512,512,"Resize and Fill"],"serialize_values":[null,null,null]},{"id":23,"type":"Note","pos":[-31.74054352111826,2166.4643290496815],"size":{"0":503.7386779785156,"1":241.082763671875},"flags":{},"order":4,"mode":0,"properties":{"text":""},"widgets_values":["1.WD14 Tagger:用于将加载的图像进行反推提示词\n2. Text box:用于添加正反向提示词。正向提示词可以通过翻译节点进行替换\n3.Text Concatenate：用于将反推的正向提示词和自己输入的正向提示词做合并输出到Styles selector节点的正向提示词中\n4.Styles Selector:我选择的是easy stylesSelector节点。这个节点的风格化很多，可以作为首选"],"color":"#57431a","bgcolor":"#6b572e","serialize_values":[null]},{"id":29,"type":"Zoe-DepthMapPreprocessor","pos":[-580.0532040100096,559.1524754562381],"size":{"0":318.97515869140625,"1":54},"flags":{},"order":33,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":61,"label":"图像"},{"name":"resolution","type":"INT","link":32,"widget":{"name":"resolution"},"slot_index":1,"label":"分辨率"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[27,62],"shape":3,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"Zoe-DepthMapPreprocessor"},"widgets_values":[512],"serialize_values":[null]},{"id":28,"type":"DWPreprocessor","pos":[-594.0532040100096,308.1524754562375],"size":{"0":330.7687683105469,"1":198},"flags":{},"order":20,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":33,"label":"图像"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[26,63],"shape":3,"label":"图像","slot_index":0},{"name":"POSE_KEYPOINT","type":"POSE_KEYPOINT","links":null,"shape":3,"label":"POSE_KEYPOINT"}],"properties":{"Node name for S&R":"DWPreprocessor"},"widgets_values":["disable","enable","enable",512,"yolox_l.onnx","dw-ll_ucoco_384_bs5.torchscript.pt"],"serialize_values":[null,null,null,null,null,null]},{"id":50,"type":"PreviewImage","pos":[161.5393252868651,170.63401232147203],"size":{"0":242.6470947265625,"1":285.4919738769531},"flags":{},"order":38,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":62,"label":"图像"}],"properties":{"Node name for S&R":"PreviewImage"},"color":"#1a5757","bgcolor":"#2e6b6b"},{"id":51,"type":"PreviewImage","pos":[161.5393252868651,513.634012321472],"size":{"0":245.688232421875,"1":363.8213806152344},"flags":{},"order":25,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":63,"label":"图像"}],"properties":{"Node name for S&R":"PreviewImage"},"color":"#1a5757","bgcolor":"#2e6b6b"},{"id":34,"type":"Note","pos":[459.45494689941427,709.5777473831183],"size":{"0":337.0581970214844,"1":150.39454650878906},"flags":{},"order":5,"mode":0,"properties":{"text":""},"widgets_values":["IPAdapter的image链接的是图生图的主体图(main image)。需要对主题图进行解析"],"color":"#57431a","bgcolor":"#6b572e","serialize_values":[null]},{"id":1,"type":"KSampler (Efficient)","pos":[885,119],"size":{"0":463.63262939453125,"1":798.3244018554688},"flags":{},"order":47,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":1,"label":"模型"},{"name":"positive","type":"CONDITIONING","link":22,"label":"正面提示词"},{"name":"negative","type":"CONDITIONING","link":23,"label":"负面提示词"},{"name":"latent_image","type":"LATENT","link":30,"label":"Latent"},{"name":"optional_vae","type":"VAE","link":31,"label":"VAE","slot_index":4},{"name":"script","type":"SCRIPT","link":null,"label":"脚本"},{"name":"seed","type":"INT","link":60,"widget":{"name":"seed"},"label":"随机种","slot_index":6}],"outputs":[{"name":"MODEL","type":"MODEL","links":[64],"shape":3,"label":"模型","slot_index":0},{"name":"CONDITIONING+","type":"CONDITIONING","links":[65],"shape":3,"label":"正面条件","slot_index":1},{"name":"CONDITIONING-","type":"CONDITIONING","links":[66],"shape":3,"label":"负面条件","slot_index":2},{"name":"LATENT","type":"LATENT","links":null,"shape":3,"label":"Latent"},{"name":"VAE","type":"VAE","links":[68],"shape":3,"label":"VAE"},{"name":"IMAGE","type":"IMAGE","links":[78],"shape":3,"label":"图像","slot_index":5}],"properties":{"Node name for S&R":"KSampler (Efficient)"},"widgets_values":[1035904390212442,null,28,7,"ddim","ddim_uniform",1,"auto","true"],"color":"#57571a","bgcolor":"#6b6b2e","shape":1,"serialize_values":[null,null,null,null,null,null,null,null,null]},{"id":45,"type":"Note","pos":[-277.7147781740989,1285.9326149878439],"size":{"0":352.52947998046875,"1":258.8822021484375},"flags":{},"order":6,"mode":0,"properties":{"text":""},"widgets_values":["1.CLIPSeg:主要是单独做1个face和1个hair的蒙版，然后通过MaskComposite节点将两者合并再反转一下进行输出。如果想做其他蒙版只需要更换simple string中的提示词即可\n2.Convert Masks to Images:这里是重点！！将脸部的蒙版转成image然后输出到放大节点，保证脸部放大后样貌不变！！！"],"color":"#57431a","bgcolor":"#6b572e","serialize_values":[null]},{"id":24,"type":"ShowText|pysssss","pos":[-45.13920947265631,1791.332699523926],"size":{"0":559.0418701171875,"1":315.9945983886719},"flags":{},"order":29,"mode":0,"inputs":[{"name":"text","type":"STRING","link":24,"widget":{"name":"text"},"label":"文本"}],"outputs":[{"name":"STRING","type":"STRING","links":null,"shape":6,"label":"字符串"}],"properties":{"Node name for S&R":"ShowText|pysssss"},"widgets_values":["1girl, solo, long_hair, breasts, looking_at_viewer, simple_background, brown_hair, black_hair, dress, holding, bare_shoulders, brown_eyes, jewelry, flower, earrings, parted_lips, grey_background, white_dress, strapless, white_flower, strapless_dress, bouquet, wedding_dress1girl, solo, long_hair, looking_at_viewer, simple_background, black_hair, dress, holding, bare_shoulders, brown_eyes, flower, parted_lips, grey_background, white_dress, lips, strapless, white_flower, strapless_dress, bouquet, wedding_dress, realistic","1girl, solo, long_hair, breasts, looking_at_viewer, simple_background, brown_hair, black_hair, dress, holding, bare_shoulders, brown_eyes, jewelry, flower, earrings, parted_lips, grey_background, white_dress, strapless, white_flower, strapless_dress, bouquet, wedding_dress1girl, solo, long_hair, looking_at_viewer, simple_background, black_hair, dress, holding, bare_shoulders, brown_eyes, flower, parted_lips, grey_background, white_dress, lips, strapless, white_flower, strapless_dress, bouquet, wedding_dress, realistic","1girl, solo, long_hair, breasts, looking_at_viewer, simple_background, brown_hair, black_hair, dress, holding, bare_shoulders, brown_eyes, jewelry, flower, earrings, parted_lips, grey_background, white_dress, strapless, white_flower, strapless_dress, bouquet, wedding_dress1girl, solo, long_hair, looking_at_viewer, bangs, brown_hair, shirt, long_sleeves, white_background, brown_eyes, flower, cowboy_shot, parted_lips, pants, nail_polish, sweater, lips, sleeves_past_wrists, denim, freckles, hand_in_pocket, jeans, realistic, yellow_flower, nose, sunflower, blue_pants"],"serialize_values":["1girl, solo, long_hair, breasts, looking_at_viewer, simple_background, brown_hair, black_hair, dress, holding, bare_shoulders, brown_eyes, jewelry, flower, earrings, parted_lips, grey_background, white_dress, strapless, white_flower, strapless_dress, bouquet, wedding_dress1girl, solo, long_hair, looking_at_viewer, simple_background, black_hair, dress, holding, bare_shoulders, brown_eyes, flower, parted_lips, grey_background, white_dress, lips, strapless, white_flower, strapless_dress, bouquet, wedding_dress, realistic",null,null]},{"id":59,"type":"UpscaleModelLoader","pos":[135,1041],"size":{"0":251.3272247314453,"1":58},"flags":{},"order":7,"mode":0,"outputs":[{"name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[76],"shape":3,"label":"放大模型"}],"properties":{"Node name for S&R":"UpscaleModelLoader"},"widgets_values":["4x-UltraSharp.pth"],"color":"#571a1a","bgcolor":"#6b2e2e","serialize_values":[null]},{"id":58,"type":"ImageUpscaleWithModel","pos":[142,1151],"size":{"0":241.79998779296875,"1":46},"flags":{},"order":48,"mode":0,"inputs":[{"name":"upscale_model","type":"UPSCALE_MODEL","link":76,"label":"放大模型","slot_index":0},{"name":"image","type":"IMAGE","link":78,"label":"图像","slot_index":1}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[80],"shape":3,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"ImageUpscaleWithModel"},"color":"#1a5757","bgcolor":"#2e6b6b"},{"id":60,"type":"Reroute","pos":[53,814],"size":[75,26],"flags":{},"order":41,"mode":0,"inputs":[{"name":"","type":"*","link":83,"label":""}],"outputs":[{"name":"VAE","type":"VAE","links":[84,92],"slot_index":0,"label":"VAE"}],"properties":{"showOutputText":true,"horizontal":false}},{"id":67,"type":"ImageScale","pos":[146,1246],"size":{"0":241.2855987548828,"1":122},"flags":{"collapsed":false},"order":35,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":90,"label":"图像","slot_index":0},{"name":"width","type":"INT","link":87,"widget":{"name":"width"},"label":"宽度","slot_index":1},{"name":"height","type":"INT","link":88,"widget":{"name":"height"},"label":"高度","slot_index":2}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[89],"shape":3,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"ImageScale"},"widgets_values":["nearest-exact",512,512,"disabled"],"color":"#1a5757","bgcolor":"#2e6b6b","serialize_values":[null,null,null,null]},{"id":53,"type":"SetLatentNoiseMask","pos":[806,1350],"size":{"0":210,"1":46},"flags":{},"order":52,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":70,"label":"Latent"},{"name":"mask","type":"MASK","link":95,"label":"遮罩"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[69],"shape":3,"label":"Latent","slot_index":0}],"properties":{"Node name for S&R":"SetLatentNoiseMask"},"color":"#1a572e","bgcolor":"#2e6b42"},{"id":68,"type":"VAEEncode","pos":[804,1234],"size":{"0":210,"1":46},"flags":{},"order":45,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":102,"label":"图像","slot_index":0},{"name":"vae","type":"VAE","link":92,"label":"VAE","slot_index":1}],"outputs":[{"name":"LATENT","type":"LATENT","links":[91],"shape":3,"label":"Latent"}],"properties":{"Node name for S&R":"VAEEncode"},"color":"#2e571a","bgcolor":"#426b2e"},{"id":55,"type":"VAEEncode","pos":[822,1114],"size":{"0":210,"1":46},"flags":{},"order":50,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":82,"label":"图像","slot_index":0},{"name":"vae","type":"VAE","link":84,"label":"VAE"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[71],"shape":3,"label":"Latent"}],"properties":{"Node name for S&R":"VAEEncode"},"color":"#2e571a","bgcolor":"#426b2e"},{"id":57,"type":"ImageScale","pos":[459,1041],"size":{"0":315,"1":130},"flags":{},"order":49,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":80,"label":"图像","slot_index":0},{"name":"width","type":"INT","link":73,"widget":{"name":"width"},"label":"宽度"},{"name":"height","type":"INT","link":74,"widget":{"name":"height"},"label":"高度"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[82],"shape":3,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"ImageScale"},"widgets_values":["nearest-exact",512,512,"disabled"],"color":"#1a5757","bgcolor":"#2e6b6b","serialize_values":[null,null,null,null]},{"id":54,"type":"LatentCompositeMasked","pos":[460,1232],"size":{"0":315,"1":146},"flags":{},"order":51,"mode":0,"inputs":[{"name":"destination","type":"LATENT","link":71,"label":"目标Latent","slot_index":0},{"name":"source","type":"LATENT","link":91,"label":"源Latent","slot_index":1},{"name":"mask","type":"MASK","link":85,"label":"遮罩","slot_index":2}],"outputs":[{"name":"LATENT","type":"LATENT","links":[70],"shape":3,"label":"Latent","slot_index":0}],"properties":{"Node name for S&R":"LatentCompositeMasked"},"widgets_values":[0,0,false],"color":"#1a572e","bgcolor":"#2e6b42","serialize_values":[null,null,null]},{"id":70,"type":"InvertMask","pos":[512,1441],"size":{"0":210,"1":26},"flags":{},"order":46,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":94,"label":"遮罩"}],"outputs":[{"name":"MASK","type":"MASK","links":[95],"shape":3,"label":"遮罩","slot_index":0}],"properties":{"Node name for S&R":"InvertMask"},"color":"#1a5743","bgcolor":"#2e6b57"},{"id":69,"type":"ConstrainImage|pysssss","pos":[762,1463],"size":{"0":302.67889404296875,"1":154},"flags":{},"order":18,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":99,"label":"图像","slot_index":0}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[101,102],"shape":6,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"ConstrainImage|pysssss"},"widgets_values":[2048,2048,0,0,"no"],"color":"#1a5757","bgcolor":"#2e6b6b","serialize_values":[null,null,null,null,null]},{"id":49,"type":"Seed Generator","pos":[386,1538],"size":{"0":315,"1":82},"flags":{},"order":8,"mode":0,"outputs":[{"name":"INT","type":"INT","links":[60,67],"shape":3,"label":"INT"}],"properties":{"Node name for S&R":"Seed Generator"},"widgets_values":[917013511710838,"randomize"],"serialize_values":[null,null]},{"id":52,"type":"KSampler (Efficient)","pos":[1089,1035],"size":{"0":354.1701354980469,"1":582.562255859375},"flags":{},"order":53,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":64,"label":"模型"},{"name":"positive","type":"CONDITIONING","link":65,"label":"正面提示词"},{"name":"negative","type":"CONDITIONING","link":66,"label":"负面提示词"},{"name":"latent_image","type":"LATENT","link":69,"label":"Latent"},{"name":"optional_vae","type":"VAE","link":68,"label":"VAE","slot_index":4},{"name":"script","type":"SCRIPT","link":null,"label":"脚本"},{"name":"seed","type":"INT","link":67,"widget":{"name":"seed"},"label":"随机种","slot_index":6}],"outputs":[{"name":"MODEL","type":"MODEL","links":null,"shape":3,"label":"模型"},{"name":"CONDITIONING+","type":"CONDITIONING","links":null,"shape":3,"label":"正面条件"},{"name":"CONDITIONING-","type":"CONDITIONING","links":null,"shape":3,"label":"负面条件"},{"name":"LATENT","type":"LATENT","links":null,"shape":3,"label":"Latent"},{"name":"VAE","type":"VAE","links":null,"shape":3,"label":"VAE"},{"name":"IMAGE","type":"IMAGE","links":[103],"shape":3,"label":"图像","slot_index":5}],"properties":{"Node name for S&R":"KSampler (Efficient)"},"widgets_values":[1035904390212442,null,10,7,"ddim","ddim_uniform",0.3,"auto","true"],"color":"#57571a","bgcolor":"#6b6b2e","shape":1,"serialize_values":[null,null,null,null,null,null,null,null,null]},{"id":8,"type":"Text box","pos":[-960.7405435211191,2252.464329049683],"size":{"0":415.60028076171875,"1":259.8477783203125},"flags":{},"order":9,"mode":0,"outputs":[{"name":"STRING","type":"STRING","links":[105],"shape":3,"label":"字符串","slot_index":0}],"properties":{"Node name for S&R":"Text box"},"widgets_values":["nwfs,text,(loli), (young), (teen), (child), (aged down), lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry, bad-hands-5, (bad_prompt_version2:0.7),, oral, simulated fellatio,(worst quality, low quality:1.4), watermark, logo,black _face,sketches, (worst quality:2), (low quality:2), (normal quality:2), lowres, normal quality, ((monochrome)), ((grayscale)), skin spots, acnes, skin blemishes, bad anatomy,(long hair:1.4),DeepNegative,(fat:1.2),facing away, looking away,tilted head, lowres,bad anatomy,bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality,jpegartifacts,signature, watermark, username,blurry,bad feet,cropped,poorly drawn hands,poorly drawn face,mutation,deformed,worst quality,low quality,normal quality,jpeg artifacts,signature,watermark,extra fingers,fewer digits,extra limbs,extra arms,extra legs,malformed limbs,fused fingers,too many fingers,long neck,cross-eyed,mutated hands,polar lowres,bad body,bad proportions,gross proportions,text,error,missing fingers,missing arms,missing legs,extra digit, extra arms, extra leg, extra foot"],"color":"#322","bgcolor":"#533","serialize_values":["nwfs,text,(loli), (young), (teen), (child), (aged down), lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry, bad-hands-5, (bad_prompt_version2:0.7),, oral, simulated fellatio,(worst quality, low quality:1.4), watermark, logo,black _face,sketches, (worst quality:2), (low quality:2), (normal quality:2), lowres, normal quality, ((monochrome)), ((grayscale)), skin spots, acnes, skin blemishes, bad anatomy,(long hair:1.4),DeepNegative,(fat:1.2),facing away, looking away,tilted head, lowres,bad anatomy,bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality,jpegartifacts,signature, watermark, username,blurry,bad feet,cropped,poorly drawn hands,poorly drawn face,mutation,deformed,worst quality,low quality,normal quality,jpeg artifacts,signature,watermark,extra fingers,fewer digits,extra limbs,extra arms,extra legs,malformed limbs,fused fingers,too many fingers,long neck,cross-eyed,mutated hands,polar lowres,bad body,bad proportions,gross proportions,text,error,missing fingers,missing arms,missing legs,extra digit, extra arms, extra leg, extra foot"]},{"id":74,"type":"SDXLPromptStyler","pos":[-497,1817],"size":{"0":400,"1":200},"flags":{},"order":30,"mode":0,"inputs":[{"name":"text_positive","type":"STRING","link":104,"widget":{"name":"text_positive"},"label":"正面提示词"},{"name":"text_negative","type":"STRING","link":105,"widget":{"name":"text_negative"},"label":"负面提示词"}],"outputs":[{"name":"text_positive","type":"STRING","links":[106],"shape":3,"label":"正面提示词","slot_index":0},{"name":"text_negative","type":"STRING","links":[107],"shape":3,"label":"负面提示词","slot_index":1}],"properties":{"Node name for S&R":"SDXLPromptStyler"},"widgets_values":["","","artstyle-hyperrealism",false],"color":"#1a4357","bgcolor":"#2e576b","serialize_values":["","",null,null]},{"id":75,"type":"Note","pos":[-2549,1110],"size":{"0":469.0990905761719,"1":179.29632568359375},"flags":{},"order":10,"mode":0,"properties":{"text":""},"widgets_values":["左边图：放置人物姿势模特图\n右边图：放置需要参考换背景服装的图\n（强调：这里无法实现完全换装，只是做人物场景融合化，并不是100%的换装）"],"color":"#57431a","bgcolor":"#6b572e","serialize_values":[null]},{"id":15,"type":"Text box","pos":[-961.7405435211191,2029.4643290496774],"size":{"0":387.4521484375,"1":172.18112182617188},"flags":{},"order":11,"mode":0,"outputs":[{"name":"STRING","type":"STRING","links":[59],"shape":3,"label":"字符串","slot_index":0}],"properties":{"Node name for S&R":"Text box"},"widgets_values":["1girl, solo, long_hair, breasts, looking_at_viewer, simple_background, brown_hair, black_hair, dress, holding, bare_shoulders, brown_eyes, jewelry, flower, earrings, parted_lips, grey_background, white_dress, strapless, white_flower, strapless_dress, bouquet, wedding_dress"],"color":"#232","bgcolor":"#353","serialize_values":["1girl, solo, long_hair, breasts, looking_at_viewer, simple_background, brown_hair, black_hair, dress, holding, bare_shoulders, brown_eyes, jewelry, flower, earrings, parted_lips, grey_background, white_dress, strapless, white_flower, strapless_dress, bouquet, wedding_dress"]},{"id":47,"type":"GetImageSize","pos":[-233,875],"size":{"0":210,"1":46},"flags":{},"order":23,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":101,"label":"图像","slot_index":0}],"outputs":[{"name":"width","type":"INT","links":[54,73,87],"shape":3,"label":"宽度","slot_index":0},{"name":"height","type":"INT","links":[55,74,88],"shape":3,"label":"高度","slot_index":1}],"properties":{"Node name for S&R":"GetImageSize"},"color":"#1a5757","bgcolor":"#2e6b6b"},{"id":66,"type":"ImageToMask","pos":[144,1437],"size":{"0":245.82867431640625,"1":58},"flags":{},"order":42,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":89,"label":"图像","slot_index":0}],"outputs":[{"name":"MASK","type":"MASK","links":[85,94],"shape":3,"label":"遮罩","slot_index":0}],"properties":{"Node name for S&R":"ImageToMask"},"widgets_values":["red"],"color":"#1a5743","bgcolor":"#2e6b57","serialize_values":[null]},{"id":46,"type":"Convert Masks to Images","pos":[-600,1484],"size":{"0":269.0486145019531,"1":31.07927894592285},"flags":{},"order":31,"mode":0,"inputs":[{"name":"masks","type":"MASK","link":49,"label":"遮罩"}],"outputs":[{"name":"IMAGES","type":"IMAGE","links":[90],"shape":3,"label":"图像","slot_index":0}],"properties":{"Node name for S&R":"Convert Masks to Images"},"color":"#1a5743","bgcolor":"#2e6b57"},{"id":10,"type":"Text Concatenate","pos":[-491,2117],"size":{"0":315,"1":178},"flags":{},"order":24,"mode":0,"inputs":[{"name":"text_a","type":"STRING","link":59,"widget":{"name":"text_a"},"slot_index":0,"label":"文本_A"},{"name":"text_b","type":"STRING","link":9,"widget":{"name":"text_b"},"label":"文本_B"},{"name":"text_c","type":"STRING","link":null,"widget":{"name":"text_c"},"label":"文本_C"},{"name":"text_d","type":"STRING","link":null,"widget":{"name":"text_d"},"label":"文本_d"}],"outputs":[{"name":"STRING","type":"STRING","links":[24,104],"shape":3,"label":"字符串","slot_index":0}],"properties":{"Node name for S&R":"Text Concatenate"},"widgets_values":["","true","","","",""],"color":"#6d5d22","bgcolor":"#817136","serialize_values":[null,null,"","",null,null]},{"id":72,"type":"Note","pos":[598,1707],"size":{"0":893.093505859375,"1":822.5439453125},"flags":{},"order":12,"mode":0,"properties":{"text":""},"widgets_values":["ImageUpscale节点：\n1.主要是通过GetImageSize和constrain image控制图像的尺寸比例范围\n2.核心是将Mask Group节点中的Convert Mask to Images节点，将人物的face蒙版转为image输出给Upscale Image，然后再反向将放大后的脸部图像通过convert image to mask再转为蒙版传输出去，最终将脸部和Upscale后的图像通过LatentCompositeMasked节点合并并输出到KSampler中\n3.提示词方面只需要将传入的图片进行反推后就能直接使用。或者输出自己想输入的提示词，简单即可。\n\n4.SDXL Prompt Styler节点的风格，个人觉得太少。可以通过fucoos节点的prompt style进行替换，因为esheep没有这个节点。因此我换回来了\n\n最后：本工作流不是本人所创(在此声明！！只是偶尔看到借鉴一下。)\n\n来自B站/小红书 赛博迪克朗 \nhttps://space.bilibili.com/339984"],"color":"#57431a","bgcolor":"#6b572e","serialize_values":[null]},{"id":21,"type":"CR LoRA Stack","pos":[-2039.0283545993495,186.9107759748505],"size":{"0":410.52484130859375,"1":357.948974609375},"flags":{},"order":13,"mode":0,"inputs":[{"name":"lora_stack","type":"LORA_STACK","link":null,"label":"LoRA堆"}],"outputs":[{"name":"LORA_STACK","type":"LORA_STACK","links":[18],"shape":3,"label":"LORA_STACK"},{"name":"show_help","type":"STRING","links":null,"shape":3,"label":"show_help"}],"properties":{"Node name for S&R":"CR LoRA Stack"},"widgets_values":["On","Add More Details - Detail Enhancer / Twe(v1)",0.8,0.64,"Off","None",0.3,0.4,"Off","None",1,1],"serialize_values":[null,"3402_5137_6006@d9cf2f88de.safetensors",null,null,null,null,null,null,null,null,null,null]},{"id":4,"type":"CLIPVisionLoader","pos":[464.4886033935548,292.0963448257448],"size":{"0":315,"1":58},"flags":{},"order":14,"mode":0,"outputs":[{"name":"CLIP_VISION","type":"CLIP_VISION","links":[3],"shape":3,"label":"CLIP视觉"}],"properties":{"Node name for S&R":"CLIPVisionLoader"},"widgets_values":["ip_adaptor_sd15_pytorch_model.bin"],"color":"#571a1a","bgcolor":"#6b2e2e","serialize_values":[null]},{"id":19,"type":"Efficient Loader","pos":[-1585.0283545993507,187.9107759748505],"size":{"0":400,"1":462},"flags":{},"order":34,"mode":0,"inputs":[{"name":"lora_stack","type":"LORA_STACK","link":18,"label":"LoRA堆","slot_index":0},{"name":"cnet_stack","type":"CONTROL_NET_STACK","link":null,"label":"ControlNet堆"},{"name":"positive","type":"STRING","link":106,"widget":{"name":"positive"},"label":"正面提示词"},{"name":"negative","type":"STRING","link":107,"widget":{"name":"negative"},"label":"负面提示词"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[19],"shape":3,"label":"模型","slot_index":0},{"name":"CONDITIONING+","type":"CONDITIONING","links":[20],"shape":3,"label":"正面条件","slot_index":1},{"name":"CONDITIONING-","type":"CONDITIONING","links":[21],"shape":3,"label":"负面条件","slot_index":2},{"name":"LATENT","type":"LATENT","links":null,"shape":3,"label":"Latent"},{"name":"VAE","type":"VAE","links":[28,31,83],"shape":3,"label":"VAE","slot_index":4},{"name":"CLIP","type":"CLIP","links":[],"shape":3,"label":"CLIP"},{"name":"DEPENDENCIES","type":"DEPENDENCIES","links":null,"shape":3,"label":"依赖"}],"properties":{"Node name for S&R":"Efficient Loader"},"widgets_values":["majicMIX realistic(v7)","vae-ft-mse-840000-ema-pruned@735e4c3a44.safetensors",-2,"None",1,1,"CLIP_POSITIVE","CLIP_NEGATIVE","none","comfy",512,512,1],"color":"#571a1a","bgcolor":"#6b2e2e","shape":1,"serialize_values":["192_3750_4424@7c819b6d13.safetensors",null,null,null,null,null,"CLIP_POSITIVE","CLIP_NEGATIVE",null,null,null,null,null]},{"id":36,"type":"LoadImage","pos":[-2052,869],"size":{"0":477.8277893066406,"1":756.8836059570312},"flags":{},"order":15,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[37,99],"shape":3,"label":"图像"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["https://bfs.esheep.com/bfs/aikobo-bfs/app/comfy/9830f915a228faff72f8ccbd4a658607afdf3a44.png@1536w_1536h_0e","image"],"color":"#1a5757","bgcolor":"#2e6b6b","serialize_values":[null,null]},{"id":6,"type":"LoadImage","pos":[-1530,886],"size":{"0":489.90130615234375,"1":764.2155151367188},"flags":{},"order":16,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[4,36],"shape":3,"label":"图像"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["https://bfs.esheep.com/bfs/aikobo-bfs/app/comfy/ad804416458f00508f8b4d7d7f29c591e6e73d1c.png@1536w_1536h_0e","image"],"color":"#1a5757","bgcolor":"#2e6b6b","serialize_values":[null,null]},{"id":73,"type":"PreviewImage","pos":[-2036,1693],"size":{"0":1012.6881103515625,"1":811.5726928710938},"flags":{},"order":54,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":103,"label":"图像"}],"properties":{"Node name for S&R":"PreviewImage"},"color":"#1a5757","bgcolor":"#2e6b6b"}],"links":[[1,2,0,1,0,"MODEL"],[2,3,0,2,0,"IPADAPTER"],[3,4,0,2,1,"CLIP_VISION"],[4,6,0,5,0,"IMAGE"],[9,5,0,10,1,"STRING"],[18,21,0,19,0,"LORA_STACK"],[19,19,0,2,3,"MODEL"],[20,19,1,22,0,"CONDITIONING"],[21,19,2,22,1,"CONDITIONING"],[22,22,0,1,1,"CONDITIONING"],[23,22,1,1,2,"CONDITIONING"],[24,10,0,24,0,"STRING"],[25,26,0,22,2,"CONTROL_NET_STACK"],[26,28,0,26,0,"IMAGE"],[27,29,0,26,1,"IMAGE"],[28,19,4,30,1,"VAE"],[29,30,0,31,0,"LATENT"],[30,31,0,1,3,"LATENT"],[31,19,4,1,4,"VAE"],[32,32,0,29,1,"INT"],[33,33,0,28,0,"IMAGE"],[35,33,0,32,0,"IMAGE"],[36,6,0,2,2,"IMAGE"],[37,36,0,33,0,"IMAGE"],[39,33,0,37,0,"IMAGE"],[40,38,0,37,1,"STRING"],[41,33,0,39,0,"IMAGE"],[42,40,0,39,1,"STRING"],[43,37,0,41,0,"MASK"],[44,39,0,42,0,"MASK"],[45,41,0,43,0,"MASK"],[46,42,0,43,1,"MASK"],[47,43,0,44,0,"MASK"],[49,41,0,46,0,"MASK"],[51,44,0,31,1,"MASK"],[53,33,0,30,0,"IMAGE"],[54,47,0,32,1,"INT"],[55,47,1,32,2,"INT"],[59,15,0,10,0,"STRING"],[60,49,0,1,6,"INT"],[61,33,0,29,0,"IMAGE"],[62,29,0,50,0,"IMAGE"],[63,28,0,51,0,"IMAGE"],[64,1,0,52,0,"MODEL"],[65,1,1,52,1,"CONDITIONING"],[66,1,2,52,2,"CONDITIONING"],[67,49,0,52,6,"INT"],[68,1,4,52,4,"VAE"],[69,53,0,52,3,"LATENT"],[70,54,0,53,0,"LATENT"],[71,55,0,54,0,"LATENT"],[73,47,0,57,1,"INT"],[74,47,1,57,2,"INT"],[76,59,0,58,0,"UPSCALE_MODEL"],[78,1,5,58,1,"IMAGE"],[80,58,0,57,0,"IMAGE"],[82,57,0,55,0,"IMAGE"],[83,19,4,60,0,"*"],[84,60,0,55,1,"VAE"],[85,66,0,54,2,"MASK"],[87,47,0,67,1,"INT"],[88,47,1,67,2,"INT"],[89,67,0,66,0,"IMAGE"],[90,46,0,67,0,"IMAGE"],[91,68,0,54,1,"LATENT"],[92,60,0,68,1,"VAE"],[94,66,0,70,0,"MASK"],[95,70,0,53,1,"MASK"],[99,36,0,69,0,"IMAGE"],[101,69,0,47,0,"IMAGE"],[102,69,0,68,0,"IMAGE"],[103,52,5,73,0,"IMAGE"],[104,10,0,74,0,"STRING"],[105,8,0,74,1,"STRING"],[106,74,0,19,2,"STRING"],[107,74,1,19,3,"STRING"]],"groups":[{"title":"Image to Image Prompt Group","bounding":[-988,1680,1568,857],"color":"#6d5d22","font_size":24,"locked":false},{"title":"IPAdapter Group","bounding":[436,90,430,840],"color":"#cb762f","font_size":24,"locked":false},{"title":"ControlNet Group","bounding":[-998,88,1425,837],"color":"#3f789e","font_size":24,"locked":false},{"title":"Mask Group","bounding":[-994,954,1112,667],"color":"#906b6b","font_size":24,"locked":false},{"title":"Load Image Group","bounding":[-2043,797,1031,1720],"color":"#3f789e","font_size":24,"locked":false},{"title":"Lora and Model Grop","bounding":[-2055,86,1039,686],"color":"#3f789e","font_size":24,"locked":false},{"title":"Image UpScale","bounding":[129,952,1344,682],"color":"#3f789e","font_size":24,"locked":false}],"config":{},"extra":{},"version":0.4}