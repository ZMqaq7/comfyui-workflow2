{"last_node_id":115,"last_link_id":141,"nodes":[{"id":99,"type":"VAEDecode","pos":[859,78],"size":{"0":210,"1":46},"flags":{},"order":13,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":128,"label":"samples","slot_index":0},{"name":"vae","type":"VAE","link":127,"label":"vae"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[129],"shape":3,"label":"IMAGE"}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":18,"type":"LayeredDiffusionDecode","pos":[858,184],"size":{"0":210,"1":102},"flags":{},"order":14,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":99,"label":"samples","slot_index":0},{"name":"images","type":"IMAGE","link":129,"label":"images","slot_index":1}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[59],"shape":3,"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":[34,60],"shape":3,"slot_index":1,"label":"MASK"}],"properties":{"Node name for S&R":"LayeredDiffusionDecode"},"widgets_values":["SDXL",562],"serialize_values":[null,null]},{"id":65,"type":"ETN_ApplyMaskToImage","pos":[1173,79],"size":{"0":210,"1":46},"flags":{},"order":16,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":59,"label":"image"},{"name":"mask","type":"MASK","link":60,"label":"mask"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[65],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"ETN_ApplyMaskToImage"}},{"id":29,"type":"MaskToImage","pos":[1182,185],"size":{"0":210,"1":26},"flags":{},"order":15,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":34,"label":"mask"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[35],"shape":3,"label":"IMAGE","slot_index":0}],"properties":{"Node name for S&R":"MaskToImage"}},{"id":30,"type":"SaveImage","pos":[1147,299],"size":{"0":370.11444091796875,"1":372.44354248046875},"flags":{},"order":17,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":35,"label":"images"}],"properties":{"Node name for S&R":"SaveImage"},"widgets_values":["ComfyUI"],"serialize_values":["ComfyUI"]},{"id":96,"type":"UltralyticsDetectorProvider","pos":[922.9993896484384,-1338.5340006510423],"size":{"0":315,"1":78},"flags":{},"order":0,"mode":0,"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[121],"shape":3,"label":"BBOX_DETECTOR"},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":null,"shape":3,"label":"SEGM_DETECTOR"}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"],"serialize_values":[null]},{"id":97,"type":"SAMLoader","pos":[910.9993896484384,-1197.5340006510423],"size":{"0":315,"1":82},"flags":{},"order":1,"mode":0,"outputs":[{"name":"SAM_MODEL","type":"SAM_MODEL","links":[122],"shape":3,"label":"SAM_MODEL"}],"properties":{"Node name for S&R":"SAMLoader"},"widgets_values":["sam_vit_b_01ec64.pth","AUTO"],"serialize_values":[null,null]},{"id":108,"type":"UltralyticsDetectorProvider","pos":[899.9993896484384,-1059.5340006510423],"size":{"0":315,"1":78},"flags":{},"order":2,"mode":0,"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":null,"shape":3,"label":"BBOX_DETECTOR"},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":[137],"shape":3,"label":"SEGM_DETECTOR"}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"],"serialize_values":[null]},{"id":109,"type":"CoreMLDetailerHookProvider","pos":[906.9993896484384,-929.5340006510423],"size":{"0":315,"1":58},"flags":{},"order":3,"mode":0,"outputs":[{"name":"DETAILER_HOOK","type":"DETAILER_HOOK","links":[138],"shape":3,"label":"DETAILER_HOOK"}],"properties":{"Node name for S&R":"CoreMLDetailerHookProvider"},"widgets_values":["512x512"],"serialize_values":[null]},{"id":98,"type":"VAEEncode","pos":[973,-113],"size":{"0":210,"1":46},"flags":{"collapsed":false},"order":11,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":123,"label":"pixels"},{"name":"vae","type":"VAE","link":124,"label":"vae","slot_index":1}],"outputs":[{"name":"LATENT","type":"LATENT","links":[128],"shape":3,"label":"LATENT","slot_index":0}],"properties":{"Node name for S&R":"VAEEncode"}},{"id":8,"type":"VAEDecode","pos":[1096,-240],"size":{"0":210,"1":46},"flags":{},"order":9,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":74,"label":"samples","slot_index":0},{"name":"vae","type":"VAE","link":87,"label":"vae"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[115],"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":95,"type":"FaceDetailer","pos":[1409.9993896484384,-1217.5340006510423],"size":{"0":586.4520874023438,"1":880},"flags":{"collapsed":false},"order":10,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":115,"label":"image","slot_index":0},{"name":"model","type":"MODEL","link":116,"label":"model","slot_index":1},{"name":"clip","type":"CLIP","link":117,"label":"clip","slot_index":2},{"name":"vae","type":"VAE","link":118,"label":"vae","slot_index":3},{"name":"positive","type":"CONDITIONING","link":119,"label":"positive","slot_index":4},{"name":"negative","type":"CONDITIONING","link":120,"label":"negative","slot_index":5},{"name":"bbox_detector","type":"BBOX_DETECTOR","link":121,"label":"bbox_detector","slot_index":6},{"name":"sam_model_opt","type":"SAM_MODEL","link":122,"label":"sam_model_opt","slot_index":7},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":137,"label":"segm_detector_opt","slot_index":8},{"name":"detailer_hook","type":"DETAILER_HOOK","link":138,"label":"detailer_hook","slot_index":9}],"outputs":[{"name":"image","type":"IMAGE","links":[123,141],"shape":3,"label":"image","slot_index":0},{"name":"cropped_refined","type":"IMAGE","links":null,"shape":6,"label":"cropped_refined"},{"name":"cropped_enhanced_alpha","type":"IMAGE","links":null,"shape":6,"label":"cropped_enhanced_alpha"},{"name":"mask","type":"MASK","links":null,"shape":3,"label":"mask"},{"name":"detailer_pipe","type":"DETAILER_PIPE","links":[],"shape":3,"label":"detailer_pipe","slot_index":4},{"name":"cnet_images","type":"IMAGE","links":null,"shape":6,"label":"cnet_images","slot_index":5}],"properties":{"Node name for S&R":"FaceDetailer"},"widgets_values":[384,true,1024,421595581177261,"randomize",20,8,"euler","normal",0.5,5,true,true,0.5,10,3,"center-1",0,0.93,0,0.7,"False",10,"",1,false,20],"serialize_values":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"",null,null,null]},{"id":70,"type":"SaveImage","pos":[1547,104],"size":{"0":340.5439147949219,"1":463.3976135253906},"flags":{},"order":18,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":65,"label":"images"}],"properties":{"Node name for S&R":"SaveImage"},"widgets_values":["ComfyUI"],"serialize_values":["ComfyUI"]},{"id":76,"type":"KSampler Adv. (Efficient)","pos":[407,-213],"size":{"0":301.9272155761719,"1":634},"flags":{"collapsed":false},"order":8,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":140,"label":"model"},{"name":"positive","type":"CONDITIONING","link":78,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":79,"label":"negative"},{"name":"latent_image","type":"LATENT","link":80,"label":"latent_image"},{"name":"optional_vae","type":"VAE","link":81,"label":"optional_vae"},{"name":"script","type":"SCRIPT","link":null,"label":"script"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[116],"shape":3,"label":"MODEL","slot_index":0},{"name":"CONDITIONING+","type":"CONDITIONING","links":[119],"shape":3,"label":"CONDITIONING+","slot_index":1},{"name":"CONDITIONING-","type":"CONDITIONING","links":[120],"shape":3,"label":"CONDITIONING-","slot_index":2},{"name":"LATENT","type":"LATENT","links":[74,99],"shape":3,"label":"LATENT","slot_index":3},{"name":"VAE","type":"VAE","links":[87,118,124,127],"shape":3,"label":"VAE","slot_index":4},{"name":"IMAGE","type":"IMAGE","links":[],"shape":3,"label":"IMAGE","slot_index":5}],"properties":{"Node name for S&R":"KSampler Adv. (Efficient)"},"widgets_values":["enable",1066732553508521,null,20,7,"euler","normal",0,10000,"disable","auto","true"],"color":"#2a363b","bgcolor":"#333355","shape":1,"serialize_values":[null,null,null,null,null,null,null,null,null,null,null,null]},{"id":81,"type":"LayeredDiffusionApply","pos":[117,-754],"size":{"0":315,"1":82},"flags":{},"order":6,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":93,"label":"model","slot_index":0}],"outputs":[{"name":"MODEL","type":"MODEL","links":[139],"shape":3,"label":"MODEL","slot_index":0}],"properties":{"Node name for S&R":"LayeredDiffusionApply"},"widgets_values":["SDXL, Conv Injection",1],"serialize_values":[null,null]},{"id":112,"type":"FreeU_V2","pos":[237,-598],"size":{"0":315,"1":130},"flags":{},"order":7,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":139,"label":"model"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[140],"shape":3,"label":"MODEL","slot_index":0}],"properties":{"Node name for S&R":"FreeU_V2"},"widgets_values":[1.3,1.4,0.9,0.2],"serialize_values":[null,null,null,null]},{"id":113,"type":"PreviewImage","pos":[2400,-1084],"size":{"0":475.07379150390625,"1":403.7368469238281},"flags":{},"order":12,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":141,"label":"images"}],"properties":{"Node name for S&R":"PreviewImage"}},{"id":77,"type":"Efficient Loader","pos":[-331,-354],"size":{"0":543.33740234375,"1":713.9203491210938},"flags":{},"order":4,"mode":0,"inputs":[{"name":"lora_stack","type":"LORA_STACK","link":null,"label":"lora_stack"},{"name":"cnet_stack","type":"CONTROL_NET_STACK","link":null,"label":"cnet_stack"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[93],"shape":3,"label":"MODEL","slot_index":0},{"name":"CONDITIONING+","type":"CONDITIONING","links":[78],"shape":3,"label":"CONDITIONING+","slot_index":1},{"name":"CONDITIONING-","type":"CONDITIONING","links":[79],"shape":3,"label":"CONDITIONING-","slot_index":2},{"name":"LATENT","type":"LATENT","links":[80],"shape":3,"label":"LATENT","slot_index":3},{"name":"VAE","type":"VAE","links":[81],"shape":3,"label":"VAE","slot_index":4},{"name":"CLIP","type":"CLIP","links":[117],"shape":3,"label":"CLIP","slot_index":5},{"name":"DEPENDENCIES","type":"DEPENDENCIES","links":null,"shape":3,"label":"DEPENDENCIES"}],"properties":{"Node name for S&R":"Efficient Loader"},"widgets_values":["RealVisXL V2.0(V2.0 (BakedVAE))","sdxl_vae@63aeecb90f.safetensors",-1,"Detail Tweaker XL(v1.0)",1,1," watermelon","EasyNegative, (worst quality:1.5), (low quality:1.5), (normal quality:1.5),(bad quality:1.5), blur，messy，lowres, paintings, sketches, normal quality, ((monochrome)), ((grayscale))，bad-artist，verybadimagenegative v1.3，ng_deepnegative v1 75t，bad_prompt_version2，artistic error，extra digits，wrong hands，bad anatomy，wrong foot，bad hands，bad feet，(bad hands)，bad proportions，bad perspective，bad image, bad anatomy，(worst quality, low quality, normal quality, bad quality:1.4), (lowres:1.3), (extra fingers, missing fingers:1.2), (poorly rendered hands:1.2), (mutation:1.1), (mutated hands:1.3), (deformed iris, deformed pupils:1.1), watermark, missing arms, missing hands, (long neck:1.4), (poorly drawn:1.3), (poorly drawn eyes:1.2), (poorly drawn hands:1.3), (poorly drawn iris:1.2), (poorly drawn pupils:1.2), (blurry:1.1), unaestheticXLv31, negativeXL_D，worst quality, low quality, sketch, cartoon, anime, manga, render, watermark, signature, label","none","comfy",1024,1024,1],"color":"#223322","bgcolor":"#665533","shape":1,"serialize_values":["2540_4077_4791@74dda471cc.safetensors",null,null,"3374_5063_5928@0d9bd1b873.safetensors",null,null," watermelon","EasyNegative, (worst quality:1.5), (low quality:1.5), (normal quality:1.5),(bad quality:1.5), blur，messy，lowres, paintings, sketches, normal quality, ((monochrome)), ((grayscale))，bad-artist，verybadimagenegative v1.3，ng_deepnegative v1 75t，bad_prompt_version2，artistic error，extra digits，wrong hands，bad anatomy，wrong foot，bad hands，bad feet，(bad hands)，bad proportions，bad perspective，bad image, bad anatomy，(worst quality, low quality, normal quality, bad quality:1.4), (lowres:1.3), (extra fingers, missing fingers:1.2), (poorly rendered hands:1.2), (mutation:1.1), (mutated hands:1.3), (deformed iris, deformed pupils:1.1), watermark, missing arms, missing hands, (long neck:1.4), (poorly drawn:1.3), (poorly drawn eyes:1.2), (poorly drawn hands:1.3), (poorly drawn iris:1.2), (poorly drawn pupils:1.2), (blurry:1.1), unaestheticXLv31, negativeXL_D，worst quality, low quality, sketch, cartoon, anime, manga, render, watermark, signature, label",null,null,null,null,null]},{"id":115,"type":"Note","pos":[-1241,-137],"size":{"0":636.387939453125,"1":317.1263427734375},"flags":{},"order":5,"mode":0,"properties":{"text":""},"widgets_values":["如果出错，一般是大模型选择不恰当造成， 还有就是采样器的模型的匹配上出了问题 "],"color":"#323","bgcolor":"#535","serialize_values":[null]}],"links":[[34,18,1,29,0,"MASK"],[35,29,0,30,0,"IMAGE"],[59,18,0,65,0,"IMAGE"],[60,18,1,65,1,"MASK"],[65,65,0,70,0,"IMAGE"],[74,76,3,8,0,"LATENT"],[78,77,1,76,1,"CONDITIONING"],[79,77,2,76,2,"CONDITIONING"],[80,77,3,76,3,"LATENT"],[81,77,4,76,4,"VAE"],[87,76,4,8,1,"VAE"],[93,77,0,81,0,"MODEL"],[99,76,3,18,0,"LATENT"],[115,8,0,95,0,"IMAGE"],[116,76,0,95,1,"MODEL"],[117,77,5,95,2,"CLIP"],[118,76,4,95,3,"VAE"],[119,76,1,95,4,"CONDITIONING"],[120,76,2,95,5,"CONDITIONING"],[121,96,0,95,6,"BBOX_DETECTOR"],[122,97,0,95,7,"SAM_MODEL"],[123,95,0,98,0,"IMAGE"],[124,76,4,98,1,"VAE"],[127,76,4,99,1,"VAE"],[128,98,0,99,0,"LATENT"],[129,99,0,18,1,"IMAGE"],[137,108,1,95,8,"SEGM_DETECTOR"],[138,109,0,95,9,"DETAILER_HOOK"],[139,81,0,112,0,"MODEL"],[140,112,0,76,0,"MODEL"],[141,95,0,113,0,"IMAGE"]],"groups":[{"title":"抠图形成透明图","bounding":[823,-10,1176,720],"color":"#3f789e","font_size":24,"locked":false},{"title":"面部细化","bounding":[864,-1438,1573,1134],"color":"#b06634","font_size":24,"locked":false}],"config":{},"extra":{},"version":0.4}