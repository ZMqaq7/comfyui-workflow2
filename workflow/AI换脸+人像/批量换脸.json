{"last_node_id": 83, "last_link_id": 131, "nodes": [{"id": 36, "type": "ImageScaleBy", "pos": [1130, 520], "size": {"0": 257.40069580078125, "1": 82}, "flags": {"collapsed": true}, "order": 9, "mode": 0, "inputs": [{"name": "image", "type": "IMAGE", "link": 82, "slot_index": 0}, {"name": "scale_by", "type": "FLOAT", "link": 83, "widget": {"name": "scale_by"}, "slot_index": 1}], "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [53, 90, 103], "shape": 3, "slot_index": 0}], "title": "Downscale Image", "properties": {"Node name for S&R": "ImageScaleBy"}, "widgets_values": ["nearest-exact", 0.35000000000000003]}, {"id": 45, "type": "PreviewImage", "pos": [1250, 800], "size": {"0": 210, "1": 246}, "flags": {}, "order": 16, "mode": 0, "inputs": [{"name": "images", "type": "IMAGE", "link": 104}], "title": "Original Image", "properties": {"Node name for S&R": "PreviewImage"}}, {"id": 42, "type": "GetImageSize", "pos": [1350, 550], "size": {"0": 188.71080017089844, "1": 46}, "flags": {"collapsed": true}, "order": 10, "mode": 0, "inputs": [{"name": "image", "type": "IMAGE", "link": 53}], "outputs": [{"name": "width", "type": "INT", "links": [55], "shape": 3, "slot_index": 0}, {"name": "height", "type": "INT", "links": [56], "shape": 3, "slot_index": 1}], "properties": {"Node name for S&R": "GetImageSize"}}, {"id": 43, "type": "CR Integer To String", "pos": [1480, 400], "size": {"0": 315, "1": 58}, "flags": {"collapsed": true}, "order": 13, "mode": 0, "inputs": [{"name": "int_", "type": "INT", "link": 55, "widget": {"name": "int_"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": [65], "shape": 3, "slot_index": 0}, {"name": "show_help", "type": "STRING", "links": null, "shape": 3}], "properties": {"Node name for S&R": "CR Integer To String"}, "widgets_values": [0]}, {"id": 40, "type": "CR Integer To String", "pos": [1480, 450], "size": {"0": 315, "1": 58}, "flags": {"collapsed": true}, "order": 14, "mode": 0, "inputs": [{"name": "int_", "type": "INT", "link": 56, "widget": {"name": "int_"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": [66], "shape": 3, "slot_index": 0}, {"name": "show_help", "type": "STRING", "links": null, "shape": 3}], "properties": {"Node name for S&R": "CR Integer To String"}, "widgets_values": [0]}, {"id": 62, "type": "Reroute", "pos": [1320, 570], "size": [75, 26], "flags": {}, "order": 11, "mode": 0, "inputs": [{"name": "", "type": "*", "link": 90}], "outputs": [{"name": "", "type": "IMAGE", "links": [129], "slot_index": 0}], "properties": {"showOutputText": false, "horizontal": false}}, {"id": 79, "type": "Reroute", "pos": [1320, 610], "size": [75, 26], "flags": {}, "order": 7, "mode": 0, "inputs": [{"name": "", "type": "*", "link": 124}], "outputs": [{"name": "", "type": "IMAGE", "links": [127], "slot_index": 0}], "properties": {"showOutputText": false, "horizontal": false}}, {"id": 49, "type": "ShowText|pysssss", "pos": [1680, 500], "size": {"0": 210, "1": 80}, "flags": {"collapsed": false}, "order": 18, "mode": 0, "inputs": [{"name": "text", "type": "STRING", "link": 66, "widget": {"name": "text"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": null, "shape": 6}], "title": "Height Input Check", "properties": {"Node name for S&R": "ShowText|pysssss"}, "widgets_values": ["2048"]}, {"id": 48, "type": "ShowText|pysssss", "pos": [1680, 380], "size": {"0": 210, "1": 80}, "flags": {}, "order": 17, "mode": 0, "inputs": [{"name": "text", "type": "STRING", "link": 65, "widget": {"name": "text"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": null, "shape": 6}], "title": "Width Input Check", "properties": {"Node name for S&R": "ShowText|pysssss"}, "widgets_values": ["2048"]}, {"id": 29, "type": "Image Save", "pos": [1920, 380], "size": {"0": 320, "1": 560}, "flags": {}, "order": 19, "mode": 0, "inputs": [{"name": "images", "type": "IMAGE", "link": 119}, {"name": "output_path", "type": "STRING", "link": 130, "widget": {"name": "output_path"}}], "properties": {"Node name for S&R": "Image Save"}, "widgets_values": ["F:\\#Projects\\1) SD Animation\\14) Golden Dress\\Refined\\4_Face_Fix", "Face_Fixed", "_", 4, "false", "png", 100, "false", "false", "false", "true", "true", "true"]}, {"id": 67, "type": "VHS_SplitImages", "pos": [1260, 760], "size": {"0": 315, "1": 118}, "flags": {"collapsed": true}, "order": 12, "mode": 0, "inputs": [{"name": "images", "type": "IMAGE", "link": 103}], "outputs": [{"name": "IMAGE_A", "type": "IMAGE", "links": [104], "shape": 3, "slot_index": 0}, {"name": "A_count", "type": "INT", "links": null, "shape": 3}, {"name": "IMAGE_B", "type": "IMAGE", "links": null, "shape": 3}, {"name": "B_count", "type": "INT", "links": null, "shape": 3}], "title": "Preview Only 5 Images", "properties": {"Node name for S&R": "VHS_SplitImages"}, "widgets_values": {"split_index": 5}}, {"id": 68, "type": "VHS_SplitImages", "pos": [1500, 760], "size": {"0": 315, "1": 118}, "flags": {"collapsed": true}, "order": 20, "mode": 0, "inputs": [{"name": "images", "type": "IMAGE", "link": 121}], "outputs": [{"name": "IMAGE_A", "type": "IMAGE", "links": [106], "shape": 3, "slot_index": 0}, {"name": "A_count", "type": "INT", "links": null, "shape": 3}, {"name": "IMAGE_B", "type": "IMAGE", "links": null, "shape": 3}, {"name": "B_count", "type": "INT", "links": null, "shape": 3}], "title": "Preview Only 5 Images", "properties": {"Node name for S&R": "VHS_SplitImages"}, "widgets_values": {"split_index": 5}}, {"id": 82, "type": "String to Text", "pos": [740, 670], "size": {"0": 320, "1": 60}, "flags": {}, "order": 0, "mode": 0, "outputs": [{"name": "STRING", "type": "STRING", "links": [130], "shape": 3, "slot_index": 0}], "title": "Output Folder Path", "properties": {"Node name for S&R": "String to Text"}, "widgets_values": ["F:\\#Projects\\2) ComfyUI AnimateDiff\\3) Batch Swap Face Test\\Output"], "color": "#323", "bgcolor": "#535"}, {"id": 78, "type": "LoadImage", "pos": [740, 770], "size": {"0": 320, "1": 314}, "flags": {}, "order": 1, "mode": 0, "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [124], "shape": 3, "slot_index": 0}, {"name": "MASK", "type": "MASK", "links": null, "shape": 3}], "title": "Input Face", "properties": {"Node name for S&R": "LoadImage"}, "widgets_values": ["Shawni-01 (1).png", "image"], "color": "#232", "bgcolor": "#353"}, {"id": 31, "type": "PrimitiveNode", "pos": [740, 330], "size": {"0": 210, "1": 80}, "flags": {}, "order": 2, "mode": 0, "outputs": [{"name": "INT", "type": "INT", "links": [68], "slot_index": 0, "widget": {"name": "start_index"}}], "title": "[Optional] Skip Frames", "properties": {"Run widget replace on values": false}, "widgets_values": [0, "fixed"]}, {"id": 83, "type": "String to Text", "pos": [740, 570], "size": {"0": 320, "1": 60}, "flags": {}, "order": 3, "mode": 0, "outputs": [{"name": "STRING", "type": "STRING", "links": [131], "shape": 3, "slot_index": 0}], "title": "Input Folder Path", "properties": {"Node name for S&R": "String to Text"}, "widgets_values": ["F:\\#Projects\\2) ComfyUI AnimateDiff\\3) Batch Swap Face Test\\Input"], "color": "#223", "bgcolor": "#335"}, {"id": 32, "type": "PrimitiveNode", "pos": [740, 450], "size": {"0": 210, "1": 80}, "flags": {}, "order": 4, "mode": 0, "outputs": [{"name": "INT", "type": "INT", "links": [44], "slot_index": 0, "widget": {"name": "image_load_cap"}}], "title": "Batch Range", "properties": {"Run widget replace on values": false}, "widgets_values": [0, "fixed"], "color": "#232", "bgcolor": "#353"}, {"id": 21, "type": "LoadImagesFromDirectory", "pos": [1110, 410], "size": {"0": 320, "1": 140}, "flags": {"collapsed": true}, "order": 8, "mode": 0, "inputs": [{"name": "image_load_cap", "type": "INT", "link": 44, "widget": {"name": "image_load_cap"}, "slot_index": 0}, {"name": "start_index", "type": "INT", "link": 68, "widget": {"name": "start_index"}}, {"name": "directory", "type": "STRING", "link": 131, "widget": {"name": "directory"}}], "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [82], "shape": 3, "slot_index": 0}, {"name": "MASK", "type": "MASK", "links": null, "shape": 3}, {"name": "INT", "type": "INT", "links": null, "shape": 3}], "title": "Input Images Folder", "properties": {"Node name for S&R": "LoadImagesFromDirectory"}, "widgets_values": ["F:\\#Projects\\1) SD Animation\\15) Anime Tell me\\LCM_Raw", 0, 0]}, {"id": 28, "type": "PreviewImage", "pos": [1490, 800], "size": {"0": 210, "1": 246}, "flags": {"collapsed": false}, "order": 21, "mode": 0, "inputs": [{"name": "images", "type": "IMAGE", "link": 106}], "title": "Output Image", "properties": {"Node name for S&R": "PreviewImage"}}, {"id": 77, "type": "ReActorFaceSwap", "pos": [1680, 650], "size": {"0": 315, "1": 290}, "flags": {"collapsed": true}, "order": 15, "mode": 0, "inputs": [{"name": "input_image", "type": "IMAGE", "link": 129}, {"name": "source_image", "type": "IMAGE", "link": 127}, {"name": "face_model", "type": "FACE_MODEL", "link": null}], "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [119, 121], "shape": 3, "slot_index": 0}, {"name": "FACE_MODEL", "type": "FACE_MODEL", "links": [], "shape": 3, "slot_index": 1}], "properties": {"Node name for S&R": "ReActorFaceSwap"}, "widgets_values": [true, "inswapper_128.onnx", "retinaface_resnet50", "none", "no", "no", "0", "0", 1]}, {"id": 65, "type": "Note", "pos": [150, 600], "size": {"0": 557.23828125, "1": 363.5209045410156}, "flags": {}, "order": 5, "mode": 0, "title": "Batch Face Swap - ReActor", "properties": {"text": ""}, "widgets_values": ["[Experimental workflow, may produce blurry results ... will try to fix this till the next update]\n\nHOW TO USE: \n\n1) Enter the Input Folder path you want to swap faces with.\n2) Enter the Output path for saving them. \n3) Batch Range and Skip Frames Works as Usual. (Keep range to 0 and skip frame to 0 to render all frames)\n4) Input Face Image to swap with. (Make sure you use front profile and close up pic of the face)\n\n*Note: The input images in the folder should all have the same dimensions else it will give Dimension error.\n* This workflow can give blurry/lowres face result in closeups...\n\n-----------------------------------------------------------------\nInstallation: \n\nhttps://github.com/Gourieff/comfyui-reactor-node\nhttps://github.com/Gourieff/sd-webui-reactor#insightfacebuild\n\nCustom Nodes: \n\nhttps://github.com/YMC-GitHub/ymc-node-suite-comfyui\nhttps://github.com/Stability-AI/stability-ComfyUI-nodes\nhttps://github.com/WASasquatch/was-node-suite-comfyui\nhttps://github.com/pythongosssss/ComfyUI-Custom-Scripts\nhttps://github.com/Suzie1/ComfyUI_Comfyroll_CustomNodes\nhttps://github.com/Kosinkadink/ComfyUI-Advanced-ControlNet\nhttps://github.com/Kosinkadink/ComfyUI-AnimateDiff-Evolved\nhttps://github.com/Kosinkadink/ComfyUI-VideoHelperSuite\nhttps://github.com/kijai/ComfyUI-KJNodes\n\n---------\n*After Installing all nodes, drag and drop the workflow again, some nodes set back to default which will give errors.\n*Do not put space in the end of folder path inputs nodes, it will give error.\n*It can take longer time to replace faces, test for 10 frames (Batch Range :10) and note time, then you can batch all.\n-----------------------------------------------------------------\n\n\nThis workflow was originally made to test face fixing for animatediff - https://youtu.be/HbfDjAMFi6w\nbut it could work as a batch face fixing / swapper for any images. \n\nIt is observed that it can also swap bad faces with good ones to some extent. Which can be an alternative way to fix faces for animatediff outputs. \n\nYou can find my other workflows for free here: patreon.com/jerrydavos \n\nNode Workflow By \nJerry Davos\n\n"], "color": "#2a363b", "bgcolor": "#3f5159", "shape": 4}, {"id": 39, "type": "FloatConstant", "pos": [740, 230], "size": {"0": 320, "1": 64}, "flags": {"collapsed": false}, "order": 6, "mode": 0, "outputs": [{"name": "value", "type": "FLOAT", "links": [83], "shape": 3, "slot_index": 0}], "title": "[Optional] Upscale/Downscale", "properties": {"Node name for S&R": "FloatConstant"}, "widgets_values": [1], "color": "#232", "bgcolor": "#353"}], "links": [[44, 32, 0, 21, 0, "INT"], [53, 36, 0, 42, 0, "IMAGE"], [55, 42, 0, 43, 0, "INT"], [56, 42, 1, 40, 0, "INT"], [65, 43, 0, 48, 0, "STRING"], [66, 40, 0, 49, 0, "STRING"], [68, 31, 0, 21, 1, "INT"], [82, 21, 0, 36, 0, "IMAGE"], [83, 39, 0, 36, 1, "FLOAT"], [90, 36, 0, 62, 0, "*"], [103, 36, 0, 67, 0, "IMAGE"], [104, 67, 0, 45, 0, "IMAGE"], [106, 68, 0, 28, 0, "IMAGE"], [119, 77, 0, 29, 0, "IMAGE"], [121, 77, 0, 68, 0, "IMAGE"], [124, 78, 0, 79, 0, "*"], [127, 79, 0, 77, 1, "IMAGE"], [129, 62, 0, 77, 0, "IMAGE"], [130, 82, 0, 29, 1, "STRING"], [131, 83, 0, 21, 2, "STRING"]], "groups": [], "config": {}, "extra": {"groupNodes": {"AD": {"nodes": [{"type": "ADE_AnimateDiffUniformContextOptions", "pos": [1772, 1146], "size": {"0": 315, "1": 154}, "flags": {"collapsed": false}, "order": 12, "mode": 0, "outputs": [{"name": "CONTEXT_OPTIONS", "type": "CONTEXT_OPTIONS", "links": [], "shape": 3}], "properties": {"Node name for S&R": "ADE_AnimateDiffUniformContextOptions"}, "widgets_values": [32, 1, 4, "uniform", true], "index": 0}, {"type": "ADE_AnimateDiffLoaderWithContext", "pos": [2134, 857], "size": {"0": 407.929931640625, "1": 190}, "flags": {"collapsed": false}, "order": 25, "mode": 0, "inputs": [{"name": "model", "type": "MODEL", "link": null}, {"name": "context_options", "type": "CONTEXT_OPTIONS", "link": null, "slot_index": 1}, {"name": "motion_lora", "type": "MOTION_LORA", "link": null}, {"name": "motion_model_settings", "type": "MOTION_MODEL_SETTINGS", "link": null}], "outputs": [{"name": "MODEL", "type": "MODEL", "links": [], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "ADE_AnimateDiffLoaderWithContext"}, "widgets_values": ["temporaldiff-v1-animatediff.safetensors", "sqrt_linear (AnimateDiff)", 1, false], "index": 1}], "links": [[null, 0, 1, 0, 2, "MODEL"], [0, 0, 1, 1, 8, "CONTEXT_OPTIONS"]], "external": [[1, 0, "MODEL"]]}, "Dimensions": {"nodes": [{"type": "ShowText|pysssss", "pos": [5744, 226], "size": [210, 76.0000228881836], "flags": {}, "order": 36, "mode": 0, "inputs": [{"name": "text", "type": "STRING", "link": null, "widget": {"name": "text"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": null, "shape": 6}], "title": "Refine Width Input Check", "properties": {"Node name for S&R": "ShowText|pysssss"}, "widgets_values": ["627"], "index": 0}, {"type": "ShowText|pysssss", "pos": [5750, 94], "size": [210, 76.00001525878906], "flags": {"collapsed": false}, "order": 37, "mode": 0, "inputs": [{"name": "text", "type": "STRING", "link": null, "widget": {"name": "text"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": null, "shape": 6}], "title": "Refine Height Input Check", "properties": {"Node name for S&R": "ShowText|pysssss"}, "widgets_values": ["1131"], "index": 1}], "links": [[null, 0, 0, 0, 43, "STRING"], [null, 0, 1, 0, 40, "STRING"]], "external": []}}}, "version": 0.4}